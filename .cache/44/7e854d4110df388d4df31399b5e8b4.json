{"id":"../node_modules/@ceramicnetwork/common/lib/stream.js","dependencies":[{"name":"/home/vitalpointai/projects/space-gems/node_modules/@ceramicnetwork/common/lib/stream.js.map","includedInParent":true,"mtime":1642247367864},{"name":"/home/vitalpointai/projects/space-gems/package.json","includedInParent":true,"mtime":1642266346920},{"name":"/home/vitalpointai/projects/space-gems/node_modules/@ceramicnetwork/common/package.json","includedInParent":true,"mtime":1642247367864},{"name":"lodash.clonedeep","loc":{"line":7,"column":51},"parent":"/home/vitalpointai/projects/space-gems/node_modules/@ceramicnetwork/common/lib/stream.js","resolved":"/home/vitalpointai/projects/space-gems/node_modules/lodash.clonedeep/index.js"},{"name":"@ceramicnetwork/streamid","loc":{"line":8,"column":27},"parent":"/home/vitalpointai/projects/space-gems/node_modules/@ceramicnetwork/common/lib/stream.js","resolved":"/home/vitalpointai/projects/space-gems/node_modules/@ceramicnetwork/streamid/lib/index.js"},{"name":"rxjs","loc":{"line":9,"column":23},"parent":"/home/vitalpointai/projects/space-gems/node_modules/@ceramicnetwork/common/lib/stream.js","resolved":"/home/vitalpointai/projects/space-gems/node_modules/rxjs/dist/esm5/index.js"},{"name":"./streamopts","loc":{"line":10,"column":29},"parent":"/home/vitalpointai/projects/space-gems/node_modules/@ceramicnetwork/common/lib/stream.js","resolved":"/home/vitalpointai/projects/space-gems/node_modules/@ceramicnetwork/common/lib/streamopts.js"}],"generated":{"js":"\"use strict\";\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.StreamStatic = exports.Stream = exports.CommitType = exports.AnchorStatus = exports.SignatureStatus = void 0;\nconst lodash_clonedeep_1 = __importDefault(require(\"lodash.clonedeep\"));\nconst streamid_1 = require(\"@ceramicnetwork/streamid\");\nconst rxjs_1 = require(\"rxjs\");\nconst streamopts_1 = require(\"./streamopts\");\nvar SignatureStatus;\n(function (SignatureStatus) {\n    SignatureStatus[SignatureStatus[\"GENESIS\"] = 0] = \"GENESIS\";\n    SignatureStatus[SignatureStatus[\"PARTIAL\"] = 1] = \"PARTIAL\";\n    SignatureStatus[SignatureStatus[\"SIGNED\"] = 2] = \"SIGNED\";\n})(SignatureStatus = exports.SignatureStatus || (exports.SignatureStatus = {}));\nvar AnchorStatus;\n(function (AnchorStatus) {\n    AnchorStatus[AnchorStatus[\"NOT_REQUESTED\"] = 0] = \"NOT_REQUESTED\";\n    AnchorStatus[AnchorStatus[\"PENDING\"] = 1] = \"PENDING\";\n    AnchorStatus[AnchorStatus[\"PROCESSING\"] = 2] = \"PROCESSING\";\n    AnchorStatus[AnchorStatus[\"ANCHORED\"] = 3] = \"ANCHORED\";\n    AnchorStatus[AnchorStatus[\"FAILED\"] = 4] = \"FAILED\";\n})(AnchorStatus = exports.AnchorStatus || (exports.AnchorStatus = {}));\nvar CommitType;\n(function (CommitType) {\n    CommitType[CommitType[\"GENESIS\"] = 0] = \"GENESIS\";\n    CommitType[CommitType[\"SIGNED\"] = 1] = \"SIGNED\";\n    CommitType[CommitType[\"ANCHOR\"] = 2] = \"ANCHOR\";\n})(CommitType = exports.CommitType || (exports.CommitType = {}));\nclass Stream extends rxjs_1.Observable {\n    constructor(state$, _context) {\n        super((subscriber) => {\n            state$.subscribe(subscriber);\n        });\n        this.state$ = state$;\n        this._context = _context;\n    }\n    get id() {\n        return new streamid_1.StreamID(this.state$.value.type, this.state$.value.log[0].cid);\n    }\n    get api() {\n        return this._context.api;\n    }\n    get metadata() {\n        var _a;\n        const { next, metadata } = this.state$.value;\n        return lodash_clonedeep_1.default((_a = next === null || next === void 0 ? void 0 : next.metadata) !== null && _a !== void 0 ? _a : metadata);\n    }\n    get content() {\n        var _a;\n        const { next, content } = this.state$.value;\n        return lodash_clonedeep_1.default((_a = next === null || next === void 0 ? void 0 : next.content) !== null && _a !== void 0 ? _a : content);\n    }\n    get controllers() {\n        return this.metadata.controllers;\n    }\n    get tip() {\n        return this.state$.value.log[this.state$.value.log.length - 1].cid;\n    }\n    get commitId() {\n        return this.id.atCommit(this.tip);\n    }\n    get allCommitIds() {\n        return this.state$.value.log.map(({ cid }) => this.id.atCommit(cid));\n    }\n    get anchorCommitIds() {\n        return this.state$.value.log\n            .filter(({ type }) => type === CommitType.ANCHOR)\n            .map(({ cid }) => this.id.atCommit(cid));\n    }\n    get state() {\n        return lodash_clonedeep_1.default(this.state$.value);\n    }\n    async sync(opts = {}) {\n        opts = { sync: streamopts_1.SyncOptions.PREFER_CACHE, ...opts };\n        const stream = await this.api.loadStream(this.id, opts);\n        this.state$.next(stream.state);\n    }\n    async requestAnchor() {\n        return this.api.requestAnchor(this.id);\n    }\n}\nexports.Stream = Stream;\nfunction StreamStatic() {\n    return (constructor) => {\n        constructor;\n    };\n}\nexports.StreamStatic = StreamStatic;\n"},"sourceMaps":{"js":{"version":3,"file":"stream.js","sourceRoot":"","sources":["../src/stream.ts"],"names":[],"mappings":";;;;;;AACA,wEAAwC;AAExC,uDAAmD;AAGnD,+BAAiC;AAGjC,6CAAoD;AAKpD,IAAY,eAIX;AAJD,WAAY,eAAe;IACzB,2DAAO,CAAA;IACP,2DAAO,CAAA;IACP,yDAAM,CAAA;AACR,CAAC,EAJW,eAAe,GAAf,uBAAe,KAAf,uBAAe,QAI1B;AAKD,IAAY,YAMX;AAND,WAAY,YAAY;IACtB,iEAAa,CAAA;IACb,qDAAO,CAAA;IACP,2DAAU,CAAA;IACV,uDAAQ,CAAA;IACR,mDAAM,CAAA;AACR,CAAC,EANW,YAAY,GAAZ,oBAAY,KAAZ,oBAAY,QAMvB;AA4ED,IAAY,UAIX;AAJD,WAAY,UAAU;IACpB,iDAAO,CAAA;IACP,+CAAM,CAAA;IACN,+CAAM,CAAA;AACR,CAAC,EAJW,UAAU,GAAV,kBAAU,KAAV,kBAAU,QAIrB;AAkDD,MAAsB,MAAO,SAAQ,iBAAuB;IAC1D,YAA+B,MAAwB,EAAU,QAAiB;QAChF,KAAK,CAAC,CAAC,UAAU,EAAE,EAAE;YACnB,MAAM,CAAC,SAAS,CAAC,UAAU,CAAC,CAAA;QAC9B,CAAC,CAAC,CAAA;QAH2B,WAAM,GAAN,MAAM,CAAkB;QAAU,aAAQ,GAAR,QAAQ,CAAS;IAIlF,CAAC;IAED,IAAI,EAAE;QACJ,OAAO,IAAI,mBAAQ,CAAC,IAAI,CAAC,MAAM,CAAC,KAAK,CAAC,IAAI,EAAE,IAAI,CAAC,MAAM,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,GAAG,CAAC,CAAA;IAC3E,CAAC;IAED,IAAI,GAAG;QACL,OAAO,IAAI,CAAC,QAAQ,CAAC,GAAG,CAAA;IAC1B,CAAC;IAED,IAAI,QAAQ;;QACV,MAAM,EAAE,IAAI,EAAE,QAAQ,EAAE,GAAG,IAAI,CAAC,MAAM,CAAC,KAAK,CAAA;QAC5C,OAAO,0BAAS,CAAC,MAAA,IAAI,aAAJ,IAAI,uBAAJ,IAAI,CAAE,QAAQ,mCAAI,QAAQ,CAAC,CAAA;IAC9C,CAAC;IAED,IAAI,OAAO;;QACT,MAAM,EAAE,IAAI,EAAE,OAAO,EAAE,GAAG,IAAI,CAAC,MAAM,CAAC,KAAK,CAAA;QAC3C,OAAO,0BAAS,CAAC,MAAA,IAAI,aAAJ,IAAI,uBAAJ,IAAI,CAAE,OAAO,mCAAI,OAAO,CAAC,CAAA;IAC5C,CAAC;IAED,IAAI,WAAW;QACb,OAAO,IAAI,CAAC,QAAQ,CAAC,WAAW,CAAA;IAClC,CAAC;IAED,IAAI,GAAG;QACL,OAAO,IAAI,CAAC,MAAM,CAAC,KAAK,CAAC,GAAG,CAAC,IAAI,CAAC,MAAM,CAAC,KAAK,CAAC,GAAG,CAAC,MAAM,GAAG,CAAC,CAAC,CAAC,GAAG,CAAA;IACpE,CAAC;IAED,IAAI,QAAQ;QACV,OAAO,IAAI,CAAC,EAAE,CAAC,QAAQ,CAAC,IAAI,CAAC,GAAG,CAAC,CAAA;IACnC,CAAC;IAKD,IAAI,YAAY;QACd,OAAO,IAAI,CAAC,MAAM,CAAC,KAAK,CAAC,GAAG,CAAC,GAAG,CAAC,CAAC,EAAE,GAAG,EAAE,EAAE,EAAE,CAAC,IAAI,CAAC,EAAE,CAAC,QAAQ,CAAC,GAAG,CAAC,CAAC,CAAA;IACtE,CAAC;IAKD,IAAI,eAAe;QACjB,OAAO,IAAI,CAAC,MAAM,CAAC,KAAK,CAAC,GAAG;aACzB,MAAM,CAAC,CAAC,EAAE,IAAI,EAAE,EAAE,EAAE,CAAC,IAAI,KAAK,UAAU,CAAC,MAAM,CAAC;aAChD,GAAG,CAAC,CAAC,EAAE,GAAG,EAAE,EAAE,EAAE,CAAC,IAAI,CAAC,EAAE,CAAC,QAAQ,CAAC,GAAG,CAAC,CAAC,CAAA;IAC5C,CAAC;IAED,IAAI,KAAK;QACP,OAAO,0BAAS,CAAC,IAAI,CAAC,MAAM,CAAC,KAAK,CAAC,CAAA;IACrC,CAAC;IAED,KAAK,CAAC,IAAI,CAAC,OAAiB,EAAE;QAC5B,IAAI,GAAG,EAAE,IAAI,EAAE,wBAAW,CAAC,YAAY,EAAE,GAAG,IAAI,EAAE,CAAA;QAClD,MAAM,MAAM,GAAG,MAAM,IAAI,CAAC,GAAG,CAAC,UAAU,CAAC,IAAI,CAAC,EAAE,EAAE,IAAI,CAAC,CAAA;QACvD,IAAI,CAAC,MAAM,CAAC,IAAI,CAAC,MAAM,CAAC,KAAK,CAAC,CAAA;IAChC,CAAC;IAED,KAAK,CAAC,aAAa;QACjB,OAAO,IAAI,CAAC,GAAG,CAAC,aAAa,CAAC,IAAI,CAAC,EAAE,CAAC,CAAA;IACxC,CAAC;CAYF;AA7ED,wBA6EC;AAMD,SAAgB,YAAY;IAC1B,OAAO,CAAc,WAAc,EAAO,EAAE;QAC1C,WAAW,CAAA;IACb,CAAC,CAAA;AACH,CAAC;AAJD,oCAIC","sourcesContent":[null]}},"error":null,"hash":"ac9e8f987c13b7f8bb5e983c55b91f13","cacheData":{"env":{}}}