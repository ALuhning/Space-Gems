{"id":"../node_modules/3id-did-provider/lib/utils.js","dependencies":[{"name":"/home/vitalpointai/projects/space-gems/node_modules/3id-did-provider/lib/utils.js.map","includedInParent":true,"mtime":1642262883137},{"name":"/home/vitalpointai/projects/space-gems/node_modules/3id-did-provider/src/utils.ts","includedInParent":true,"mtime":1642262883137},{"name":"/home/vitalpointai/projects/space-gems/package.json","includedInParent":true,"mtime":1642266346920},{"name":"/home/vitalpointai/projects/space-gems/node_modules/3id-did-provider/package.json","includedInParent":true,"mtime":1642262883137},{"name":"/home/vitalpointai/projects/space-gems/node_modules/3id-did-provider/.babelrc","includedInParent":true,"mtime":1642262883137},{"name":"fast-json-stable-stringify","loc":{"line":26,"column":61},"parent":"/home/vitalpointai/projects/space-gems/node_modules/3id-did-provider/lib/utils.js","resolved":"/home/vitalpointai/projects/space-gems/node_modules/fast-json-stable-stringify/index.js"},{"name":"uint8arrays","loc":{"line":27,"column":33},"parent":"/home/vitalpointai/projects/space-gems/node_modules/3id-did-provider/lib/utils.js","resolved":"/home/vitalpointai/projects/space-gems/node_modules/uint8arrays/index.js"}],"generated":{"js":"\"use strict\";\nvar __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    Object.defineProperty(o, k2, { enumerable: true, get: function() { return m[k]; } });\n}) : (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    o[k2] = m[k];\n}));\nvar __setModuleDefault = (this && this.__setModuleDefault) || (Object.create ? (function(o, v) {\n    Object.defineProperty(o, \"default\", { enumerable: true, value: v });\n}) : function(o, v) {\n    o[\"default\"] = v;\n});\nvar __importStar = (this && this.__importStar) || function (mod) {\n    if (mod && mod.__esModule) return mod;\n    var result = {};\n    if (mod != null) for (var k in mod) if (k !== \"default\" && Object.prototype.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);\n    __setModuleDefault(result, mod);\n    return result;\n};\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.toStableObject = exports.decodeBase64 = exports.encodeBase64 = exports.u8aToHex = exports.hexToU8A = exports.parseJWEKids = exports.decodeKey = exports.encodeKey = void 0;\nconst fast_json_stable_stringify_1 = __importDefault(require(\"fast-json-stable-stringify\"));\nconst u8a = __importStar(require(\"uint8arrays\"));\nconst B16 = 'base16';\nconst B64 = 'base64pad';\nconst multicodecPubkeyTable = {\n    secp256k1: 0xe7,\n    x25519: 0xec,\n    ed25519: 0xed,\n};\nfunction encodeKey(key, keyType) {\n    const bytes = new Uint8Array(key.length + 2);\n    if (!multicodecPubkeyTable[keyType]) {\n        throw new Error(`Key type \"${keyType}\" not supported.`);\n    }\n    bytes[0] = multicodecPubkeyTable[keyType];\n    bytes[1] = 0x01;\n    bytes.set(key, 2);\n    return `z${u8a.toString(bytes, 'base58btc')}`;\n}\nexports.encodeKey = encodeKey;\nfunction decodeKey(key) {\n    const bytes = u8a.fromString(key.slice(1), 'base58btc');\n    const supportedKey = bytes[1] === 0x01 &&\n        (multicodecPubkeyTable['secp256k1'] === bytes[0] ||\n            multicodecPubkeyTable['x25519'] === bytes[0] ||\n            multicodecPubkeyTable['ed25519'] === bytes[0]);\n    if (!supportedKey)\n        throw new Error(`Key type ${bytes[0]} not supported`);\n    return bytes.slice(2);\n}\nexports.decodeKey = decodeKey;\nfunction parseJWEKids(jwe) {\n    var _a;\n    return (((_a = jwe.recipients) === null || _a === void 0 ? void 0 : _a.reduce((kids, recipient) => {\n        var _a;\n        if ((_a = recipient.header) === null || _a === void 0 ? void 0 : _a.kid)\n            kids.push(recipient.header.kid.split('#')[1]);\n        return kids;\n    }, [])) || []);\n}\nexports.parseJWEKids = parseJWEKids;\nfunction hexToU8A(s) {\n    return u8a.fromString(s, B16);\n}\nexports.hexToU8A = hexToU8A;\nfunction u8aToHex(b) {\n    return u8a.toString(b, B16);\n}\nexports.u8aToHex = u8aToHex;\nfunction encodeBase64(b) {\n    return u8a.toString(b, B64);\n}\nexports.encodeBase64 = encodeBase64;\nfunction decodeBase64(s) {\n    return u8a.fromString(s, B64);\n}\nexports.decodeBase64 = decodeBase64;\nfunction toStableObject(obj) {\n    return JSON.parse(fast_json_stable_stringify_1.default(obj));\n}\nexports.toStableObject = toStableObject;\n"},"sourceMaps":{"js":{"version":3,"file":"utils.js","sourceRoot":"","sources":["../src/utils.ts"],"names":[],"mappings":"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","sourcesContent":["import stringify from 'fast-json-stable-stringify'\nimport * as u8a from 'uint8arrays'\n\nimport type { JWE } from 'did-jwt'\n\nconst B16 = 'base16'\nconst B64 = 'base64pad'\n\nconst multicodecPubkeyTable: Record<string, number> = {\n  secp256k1: 0xe7,\n  x25519: 0xec,\n  ed25519: 0xed,\n}\n\nexport function encodeKey(key: Uint8Array, keyType: string): string {\n  const bytes = new Uint8Array(key.length + 2)\n  if (!multicodecPubkeyTable[keyType]) {\n    throw new Error(`Key type \"${keyType}\" not supported.`)\n  }\n  bytes[0] = multicodecPubkeyTable[keyType]\n  // The multicodec is encoded as a varint so we need to add this.\n  // See js-multicodec for a general implementation\n  bytes[1] = 0x01\n  bytes.set(key, 2)\n  return `z${u8a.toString(bytes, 'base58btc')}`\n}\n\nexport function decodeKey(key: string): Uint8Array {\n  // remove 'z' and decode bytes\n  const bytes = u8a.fromString(key.slice(1), 'base58btc')\n  const supportedKey =\n    bytes[1] === 0x01 &&\n    (multicodecPubkeyTable['secp256k1'] === bytes[0] ||\n      multicodecPubkeyTable['x25519'] === bytes[0] ||\n      multicodecPubkeyTable['ed25519'] === bytes[0])\n  if (!supportedKey) throw new Error(`Key type ${bytes[0]} not supported`)\n  return bytes.slice(2)\n}\n\nexport function parseJWEKids(jwe: JWE): Array<string> {\n  return (\n    jwe.recipients?.reduce((kids: Array<string>, recipient): Array<string> => {\n      if (recipient.header?.kid) kids.push(recipient.header.kid.split('#')[1])\n      return kids\n    }, []) || []\n  )\n}\n\nexport function hexToU8A(s: string): Uint8Array {\n  return u8a.fromString(s, B16)\n}\n\nexport function u8aToHex(b: Uint8Array): string {\n  return u8a.toString(b, B16)\n}\n\nexport function encodeBase64(b: Uint8Array): string {\n  return u8a.toString(b, B64)\n}\n\nexport function decodeBase64(s: string): Uint8Array {\n  return u8a.fromString(s, B64)\n}\n\nexport function toStableObject(obj: Record<string, any>): Record<string, any> {\n  return JSON.parse(stringify(obj)) as Record<string, any>\n}\n"]}},"error":null,"hash":"c3a1e830fd2b9dad68a5d968b2a75d7f","cacheData":{"env":{}}}