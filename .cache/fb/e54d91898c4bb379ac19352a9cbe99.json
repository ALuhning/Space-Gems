{"id":"../node_modules/key-did-resolver/lib/index.js","dependencies":[{"name":"/home/vitalpointai/projects/space-gems/node_modules/key-did-resolver/lib/index.js.map","includedInParent":true,"mtime":1642262883633},{"name":"/home/vitalpointai/projects/space-gems/package.json","includedInParent":true,"mtime":1642266346920},{"name":"/home/vitalpointai/projects/space-gems/node_modules/key-did-resolver/package.json","includedInParent":true,"mtime":1642262883633},{"name":"varint","loc":{"line":26,"column":41},"parent":"/home/vitalpointai/projects/space-gems/node_modules/key-did-resolver/lib/index.js","resolved":"/home/vitalpointai/projects/space-gems/node_modules/varint/index.js"},{"name":"multibase","loc":{"line":27,"column":44},"parent":"/home/vitalpointai/projects/space-gems/node_modules/key-did-resolver/lib/index.js","resolved":"/home/vitalpointai/projects/space-gems/node_modules/multibase/src/index.js"},{"name":"./secp256k1","loc":{"line":28,"column":39},"parent":"/home/vitalpointai/projects/space-gems/node_modules/key-did-resolver/lib/index.js","resolved":"/home/vitalpointai/projects/space-gems/node_modules/key-did-resolver/lib/secp256k1.js"},{"name":"./ed25519","loc":{"line":29,"column":37},"parent":"/home/vitalpointai/projects/space-gems/node_modules/key-did-resolver/lib/index.js","resolved":"/home/vitalpointai/projects/space-gems/node_modules/key-did-resolver/lib/ed25519.js"}],"generated":{"js":"\"use strict\";\nvar __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    Object.defineProperty(o, k2, { enumerable: true, get: function() { return m[k]; } });\n}) : (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    o[k2] = m[k];\n}));\nvar __setModuleDefault = (this && this.__setModuleDefault) || (Object.create ? (function(o, v) {\n    Object.defineProperty(o, \"default\", { enumerable: true, value: v });\n}) : function(o, v) {\n    o[\"default\"] = v;\n});\nvar __importStar = (this && this.__importStar) || function (mod) {\n    if (mod && mod.__esModule) return mod;\n    var result = {};\n    if (mod != null) for (var k in mod) if (k !== \"default\" && Object.prototype.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);\n    __setModuleDefault(result, mod);\n    return result;\n};\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.getResolver = void 0;\nconst varint_1 = __importDefault(require(\"varint\"));\nconst multibase_1 = __importDefault(require(\"multibase\"));\nconst secp256k1 = __importStar(require(\"./secp256k1\"));\nconst ed25519 = __importStar(require(\"./ed25519\"));\nconst DID_LD_JSON = 'application/did+ld+json';\nconst DID_JSON = 'application/did+json';\nconst prefixToDriverMap = {\n    0xe7: secp256k1,\n    0xed: ed25519,\n};\nfunction getResolver() {\n    return {\n        key: async (did, parsed, r, options) => {\n            const contentType = options.accept || DID_JSON;\n            const response = {\n                didResolutionMetadata: { contentType },\n                didDocument: null,\n                didDocumentMetadata: {},\n            };\n            try {\n                const multicodecPubKey = multibase_1.default.decode(parsed.id);\n                const keyType = varint_1.default.decode(multicodecPubKey);\n                const pubKeyBytes = multicodecPubKey.slice(varint_1.default.decode.bytes);\n                const doc = await prefixToDriverMap[keyType].keyToDidDoc(pubKeyBytes, parsed.id);\n                if (contentType === DID_LD_JSON) {\n                    doc['@context'] = 'https://w3id.org/did/v1';\n                    response.didDocument = doc;\n                }\n                else if (contentType === DID_JSON) {\n                    response.didDocument = doc;\n                }\n                else {\n                    delete response.didResolutionMetadata.contentType;\n                    response.didResolutionMetadata.error = 'representationNotSupported';\n                }\n            }\n            catch (e) {\n                response.didResolutionMetadata.error = 'invalidDid';\n                response.didResolutionMetadata.message = e.toString();\n            }\n            return response;\n        },\n    };\n}\nexports.getResolver = getResolver;\nexports.default = { getResolver };\n"},"sourceMaps":{"js":{"version":3,"file":"index.js","sourceRoot":"","sources":["../src/index.ts"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;AAAA,oDAA2B;AAC3B,0DAAiC;AASjC,uDAAwC;AACxC,mDAAoC;AAEpC,MAAM,WAAW,GAAG,yBAAyB,CAAA;AAC7C,MAAM,QAAQ,GAAG,sBAAsB,CAAA;AAEvC,MAAM,iBAAiB,GAAQ;IAC7B,IAAI,EAAE,SAAS;IACf,IAAI,EAAE,OAAO;CACd,CAAA;AAED,SAAgB,WAAW;IACzB,OAAO;QACL,GAAG,EAAE,KAAK,EACR,GAAW,EACX,MAAiB,EACjB,CAAW,EACX,OAA6B,EACC,EAAE;YAChC,MAAM,WAAW,GAAG,OAAO,CAAC,MAAM,IAAI,QAAQ,CAAA;YAC9C,MAAM,QAAQ,GAAwB;gBACpC,qBAAqB,EAAE,EAAE,WAAW,EAAE;gBACtC,WAAW,EAAE,IAAI;gBACjB,mBAAmB,EAAE,EAAE;aACxB,CAAA;YACD,IAAI;gBACF,MAAM,gBAAgB,GAAQ,mBAAS,CAAC,MAAM,CAAC,MAAM,CAAC,EAAE,CAAC,CAAA;gBACzD,MAAM,OAAO,GAAG,gBAAM,CAAC,MAAM,CAAC,gBAAgB,CAAC,CAAA;gBAC/C,MAAM,WAAW,GAAG,gBAAgB,CAAC,KAAK,CAAC,gBAAM,CAAC,MAAM,CAAC,KAAK,CAAC,CAAA;gBAC/D,MAAM,GAAG,GAAG,MAAM,iBAAiB,CAAC,OAAO,CAAC,CAAC,WAAW,CAAC,WAAW,EAAE,MAAM,CAAC,EAAE,CAAC,CAAA;gBAChF,IAAI,WAAW,KAAK,WAAW,EAAE;oBAC/B,GAAG,CAAC,UAAU,CAAC,GAAG,yBAAyB,CAAA;oBAC3C,QAAQ,CAAC,WAAW,GAAG,GAAG,CAAA;iBAC3B;qBAAM,IAAI,WAAW,KAAK,QAAQ,EAAE;oBACnC,QAAQ,CAAC,WAAW,GAAG,GAAG,CAAA;iBAC3B;qBAAM;oBACL,OAAO,QAAQ,CAAC,qBAAqB,CAAC,WAAW,CAAA;oBACjD,QAAQ,CAAC,qBAAqB,CAAC,KAAK,GAAG,4BAA4B,CAAA;iBACpE;aACF;YAAC,OAAO,CAAC,EAAE;gBACV,QAAQ,CAAC,qBAAqB,CAAC,KAAK,GAAG,YAAY,CAAA;gBACnD,QAAQ,CAAC,qBAAqB,CAAC,OAAO,GAAG,CAAC,CAAC,QAAQ,EAAE,CAAA;aACtD;YACD,OAAO,QAAQ,CAAA;QACjB,CAAC;KACF,CAAA;AACH,CAAC;AAnCD,kCAmCC;AAED,kBAAe,EAAE,WAAW,EAAE,CAAA","sourcesContent":[null]}},"error":null,"hash":"a1e8ddc814e387d82c5cb643511ac59a","cacheData":{"env":{}}}